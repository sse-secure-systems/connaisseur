
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Admission controller for Kubernetes integrating container image signature verification and trust pinning into a cluster to ensure that only valid images are being deployed - simple, flexible, secure.">
      
      
      
      
        <link rel="canonical" href="https://sse-secure-systems.github.io/connaisseur/develop/basics/">
      
      <link rel="icon" href="../assets/favicon.svg">
      <meta name="generator" content="mkdocs-1.2.2, mkdocs-material-7.2.4">
    
    
      
        <title>Basics - CONNAISSEUR - Verify Container Image Signatures in Kubernetes</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.f7f47774.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.3f5d1f46.min.css">
        
          
          
          <meta name="theme-color" content="#2094f3">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
    
      


    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="blue" data-md-color-accent="">
  
    
    <script>function __prefix(e){return new URL("..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#basics" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
        <aside class="md-banner md-announce">
          <div class="md-banner__inner md-announce__inner md-grid md-typeset">
            
  <!-- Add your announcement here, including arbitrary HTML -->
   <header style="font-size:17px">
        <center>&#11088; <strong> If you like Connaisseur, give it a star on <a href="https://github.com/sse-secure-systems/connaisseur">GitHub</a> or share your <a href="https://github.com/sse-secure-systems/connaisseur/discussions">feedback</a>!</strong> &#11088;</center>

          </div>
        </aside>
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="CONNAISSEUR - Verify Container Image Signatures in Kubernetes" class="md-header__button md-logo" aria-label="CONNAISSEUR - Verify Container Image Signatures in Kubernetes" data-md-component="logo">
      
  <img src="../assets/logo.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            CONNAISSEUR - Verify Container Image Signatures in Kubernetes
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Basics
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        
<a href="https://github.com/sse-secure-systems/connaisseur" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    sse-secure-systems/connaisseur
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="CONNAISSEUR - Verify Container Image Signatures in Kubernetes" class="md-nav__button md-logo" aria-label="CONNAISSEUR - Verify Container Image Signatures in Kubernetes" data-md-component="logo">
      
  <img src="../assets/logo.svg" alt="logo">

    </a>
    CONNAISSEUR - Verify Container Image Signatures in Kubernetes
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/sse-secure-systems/connaisseur" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    sse-secure-systems/connaisseur
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../getting_started/" class="md-nav__link">
        Getting Started
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" checked>
      
      <label class="md-nav__link" for="__nav_3">
        Usage
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Usage" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Usage
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Basics
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Basics
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#admission-control-validators-and-image-policy" class="md-nav__link">
    Admission control, validators and image policy
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#using-connaisseur" class="md-nav__link">
    Using Connaisseur
  </a>
  
    <nav class="md-nav" aria-label="Using Connaisseur">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#requirements" class="md-nav__link">
    Requirements
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get-the-code" class="md-nav__link">
    Get the code
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configure" class="md-nav__link">
    Configure
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deploy" class="md-nav__link">
    Deploy
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#check" class="md-nav__link">
    Check
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#use" class="md-nav__link">
    Use
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#delete" class="md-nav__link">
    Delete
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#makefile" class="md-nav__link">
    Makefile
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#detailed-configuration" class="md-nav__link">
    Detailed configuration
  </a>
  
    <nav class="md-nav" aria-label="Detailed configuration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#validators" class="md-nav__link">
    Validators
  </a>
  
    <nav class="md-nav" aria-label="Validators">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#configuration-options" class="md-nav__link">
    Configuration options
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example" class="md-nav__link">
    Example
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#static-validators" class="md-nav__link">
    Static validators
  </a>
  
    <nav class="md-nav" aria-label="Static validators">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#configuration-options_1" class="md-nav__link">
    Configuration options
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example_1" class="md-nav__link">
    Example
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#image-policy" class="md-nav__link">
    Image policy
  </a>
  
    <nav class="md-nav" aria-label="Image policy">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#configuration-options_2" class="md-nav__link">
    Configuration options
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example_2" class="md-nav__link">
    Example
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#common-examples" class="md-nav__link">
    Common examples
  </a>
  
    <nav class="md-nav" aria-label="Common examples">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#case-only-validate-own-images-and-deny-all-others" class="md-nav__link">
    Case: Only validate own images and deny all others
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#case-only-validate-own-images-and-deny-all-others-faster" class="md-nav__link">
    Case: Only validate own images and deny all others (faster)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#case-only-validate-docker-hub-official-images-and-deny-all-others" class="md-nav__link">
    Case: Only validate Docker Hub official images and deny all others
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#case-only-validate-docker-hub-official-images-and-allow-all-others" class="md-nav__link">
    Case: Only validate Docker Hub official images and allow all others
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#case-directly-admit-own-images-and-deny-all-others" class="md-nav__link">
    Case: Directly admit own images and deny all others
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_2" type="checkbox" id="__nav_3_2" >
      
      <label class="md-nav__link" for="__nav_3_2">
        Validators
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Validators" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_2">
          <span class="md-nav__icon md-icon"></span>
          Validators
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../validators/" class="md-nav__link">
        Overview
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../validators/notaryv1/" class="md-nav__link">
        Notary (V1) / DCT
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../validators/sigstore_cosign/" class="md-nav__link">
        sigstore / Cosign
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../validators/notaryv2/" class="md-nav__link">
        Notary V2
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_3" type="checkbox" id="__nav_3_3" >
      
      <label class="md-nav__link" for="__nav_3_3">
        Features
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Features" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_3">
          <span class="md-nav__icon md-icon"></span>
          Features
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../features/" class="md-nav__link">
        Overview
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../features/detection_mode/" class="md-nav__link">
        Detection Mode
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../features/namespaced_validation/" class="md-nav__link">
        Namespaced Validation
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../features/alerting/" class="md-nav__link">
        Alerting
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      <label class="md-nav__link" for="__nav_4">
        Security
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Security" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Security
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../threat_model/" class="md-nav__link">
        Threat Model
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../SECURITY/" class="md-nav__link">
        Security Policy
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" >
      
      <label class="md-nav__link" for="__nav_5">
        Development
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Development" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Development
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../CONTRIBUTING/" class="md-nav__link">
        Contributing
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../RELEASING/" class="md-nav__link">
        Releasing
      </a>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5_3" type="checkbox" id="__nav_5_3" >
      
      <label class="md-nav__link" for="__nav_5_3">
        ADRs
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="ADRs" data-md-level="2">
        <label class="md-nav__title" for="__nav_5_3">
          <span class="md-nav__icon md-icon"></span>
          ADRs
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../adr/" class="md-nav__link">
        Architecture Decision Records
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../adr/ADR-1_bootstrap-sentinel/" class="md-nav__link">
        ADR 1: Bootstrap Sentinel
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../adr/ADR-2_release-management/" class="md-nav__link">
        ADR 2: Release Management
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../adr/ADR-3_multi_notary_config/" class="md-nav__link">
        ADR 3: Multiple Notary Configuration
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../adr/ADR-4_modular/" class="md-nav__link">
        ADR 4: Modular Validation
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="https://github.com/sse-secure-systems/connaisseur/releases" class="md-nav__link">
        Releases ⧉
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="https://github.com/sse-secure-systems/connaisseur/discussions" class="md-nav__link">
        Support ⧉
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#admission-control-validators-and-image-policy" class="md-nav__link">
    Admission control, validators and image policy
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#using-connaisseur" class="md-nav__link">
    Using Connaisseur
  </a>
  
    <nav class="md-nav" aria-label="Using Connaisseur">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#requirements" class="md-nav__link">
    Requirements
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get-the-code" class="md-nav__link">
    Get the code
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configure" class="md-nav__link">
    Configure
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deploy" class="md-nav__link">
    Deploy
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#check" class="md-nav__link">
    Check
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#use" class="md-nav__link">
    Use
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#delete" class="md-nav__link">
    Delete
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#makefile" class="md-nav__link">
    Makefile
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#detailed-configuration" class="md-nav__link">
    Detailed configuration
  </a>
  
    <nav class="md-nav" aria-label="Detailed configuration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#validators" class="md-nav__link">
    Validators
  </a>
  
    <nav class="md-nav" aria-label="Validators">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#configuration-options" class="md-nav__link">
    Configuration options
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example" class="md-nav__link">
    Example
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#static-validators" class="md-nav__link">
    Static validators
  </a>
  
    <nav class="md-nav" aria-label="Static validators">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#configuration-options_1" class="md-nav__link">
    Configuration options
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example_1" class="md-nav__link">
    Example
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#image-policy" class="md-nav__link">
    Image policy
  </a>
  
    <nav class="md-nav" aria-label="Image policy">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#configuration-options_2" class="md-nav__link">
    Configuration options
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example_2" class="md-nav__link">
    Example
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#common-examples" class="md-nav__link">
    Common examples
  </a>
  
    <nav class="md-nav" aria-label="Common examples">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#case-only-validate-own-images-and-deny-all-others" class="md-nav__link">
    Case: Only validate own images and deny all others
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#case-only-validate-own-images-and-deny-all-others-faster" class="md-nav__link">
    Case: Only validate own images and deny all others (faster)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#case-only-validate-docker-hub-official-images-and-deny-all-others" class="md-nav__link">
    Case: Only validate Docker Hub official images and deny all others
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#case-only-validate-docker-hub-official-images-and-allow-all-others" class="md-nav__link">
    Case: Only validate Docker Hub official images and allow all others
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#case-directly-admit-own-images-and-deny-all-others" class="md-nav__link">
    Case: Directly admit own images and deny all others
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="basics">Basics<a class="headerlink" href="#basics" title="Permanent link">⚓︎</a></h1>
<p>In the following, we aim to lay the foundation on Connaisseur's core concepts, how to configure and administer it.</p>
<h2 id="admission-control-validators-and-image-policy">Admission control, validators and image policy<a class="headerlink" href="#admission-control-validators-and-image-policy" title="Permanent link">⚓︎</a></h2>
<p>Connaisseur works as a <a href="https://kubernetes.io/docs/reference/access-authn-authz/admission-controllers/">mutating admission controller</a>.
It intercepts all <em>CREATE</em> and <em>UPDATE</em> resource requests for <em>Pods</em>, <em>Deployments</em>, <em>ReplicationControllers</em>, <em>ReplicaSets</em>, <em>DaemonSets</em>, <em>StatefulSets</em>, <em>Jobs</em>, and <em>CronJobs</em> and extracts all image references for validation.
Validation relies on two core concepts: image policy and validators.
A validator is a set of configuration options required for validation like the type of signature, public key to use for verification, path to signature data, or authentication.
The image policy defines a set of rules which maps different images to those validators.
This is done via glob matching of the image name which for example allows to use different validators for different registries, repositories, images or even tags.
This is specifically useful when using public or external images from other entities like Docker's official images or different keys in a more complex development team.</p>
<p><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8 1.5c-2.363 0-4 1.69-4 3.75 0 .984.424 1.625.984 2.304l.214.253c.223.264.47.556.673.848.284.411.537.896.621 1.49a.75.75 0 0 1-1.484.211c-.04-.282-.163-.547-.37-.847a8.695 8.695 0 0 0-.542-.68c-.084-.1-.173-.205-.268-.32C3.201 7.75 2.5 6.766 2.5 5.25 2.5 2.31 4.863 0 8 0s5.5 2.31 5.5 5.25c0 1.516-.701 2.5-1.328 3.259-.095.115-.184.22-.268.319-.207.245-.383.453-.541.681-.208.3-.33.565-.37.847a.75.75 0 0 1-1.485-.212c.084-.593.337-1.078.621-1.489.203-.292.45-.584.673-.848.075-.088.147-.173.213-.253.561-.679.985-1.32.985-2.304 0-2.06-1.637-3.75-4-3.75zM6 15.25a.75.75 0 0 1 .75-.75h2.5a.75.75 0 0 1 0 1.5h-2.5a.75.75 0 0 1-.75-.75zM5.75 12a.75.75 0 0 0 0 1.5h4.5a.75.75 0 0 0 0-1.5h-4.5z"/></svg></span> <strong>Note</strong>: Typically, the public key of a known entity is used to validate the signature over an image's content in order to ensure integrity and provenance.
However, other ways to implement such trust pinning exist and as a consequence we refer to all types of trust anchors in a generalized form as <em>trust roots</em>.</p>
<h2 id="using-connaisseur">Using Connaisseur<a class="headerlink" href="#using-connaisseur" title="Permanent link">⚓︎</a></h2>
<p>Some general administration tasks like deployment or uninstallation when using Connaisseur are described in this section.</p>
<h3 id="requirements">Requirements<a class="headerlink" href="#requirements" title="Permanent link">⚓︎</a></h3>
<p>Using Connaisseur requires <a href="https://git-scm.com/">Git</a>, some <a href="https://kubernetes.io/">Kubernetes</a> cluster, <a href="https://helm.sh/">Helm</a> and <a href="https://www.docker.com/">Docker</a> (only for local setups) to be installed and set up.</p>
<h3 id="get-the-code">Get the code<a class="headerlink" href="#get-the-code" title="Permanent link">⚓︎</a></h3>
<p>The Connaisseur source code can be cloned directly from GitHub and includes the application and Helm charts in a single repository:</p>
<div class="highlight"><pre><span></span><code>git clone https://github.com/sse-secure-systems/connaisseur.git
</code></pre></div>
<h3 id="configure">Configure<a class="headerlink" href="#configure" title="Permanent link">⚓︎</a></h3>
<p>The configuration of Connaisseur is completely done in the <code>helm/values.yaml</code>.
The upper <code>deployment</code> section offers some general Kubernetes typical configurations like image version or resources.
The actual configuration consists of the <code>validators</code> and image <code>policy</code> sections.
These are described in detail <a href="#detailed-configuration">below</a> and for initials steps it is instructive to follow the <a href="../getting_started/">getting started guide</a>.
Other features are described on the <a href="../features/">respective pages</a>.</p>
<p>Connaisseur ships with a pre-configuration that does not need any adjustments for testing.
However, validating your own images requires additional configuration.</p>
<h3 id="deploy">Deploy<a class="headerlink" href="#deploy" title="Permanent link">⚓︎</a></h3>
<p>Install Connaisseur by using Helm:</p>
<div class="highlight"><pre><span></span><code>helm install connaisseur helm --atomic --create-namespace --namespace connaisseur
</code></pre></div>
<p>This will install Connaisseur in its own namespace called <code>connaisseur</code>.
The installation itself may take a moment, as the installation order of the Connaisseur components is critical.
Only when the Connaisseur pods are up and running, the admission webhook can be applied for intercepting requests.</p>
<h3 id="check">Check<a class="headerlink" href="#check" title="Permanent link">⚓︎</a></h3>
<p>Once everything is installed, you can check whether all the pods are up by running <code>kubectl get all -n connaisseur</code>:</p>
<div class="highlight"><pre><span></span><code>kubectl get all -n connaisseur
&gt; NAME                                          READY   STATUS    RESTARTS   AGE
&gt; pod/connaisseur-deployment-78d8975596-42tkw   <span class="m">1</span>/1     Running   <span class="m">0</span>          22s
&gt; pod/connaisseur-deployment-78d8975596-5c4c6   <span class="m">1</span>/1     Running   <span class="m">0</span>          22s
&gt; pod/connaisseur-deployment-78d8975596-kvrj6   <span class="m">1</span>/1     Running   <span class="m">0</span>          22s
&gt;
&gt; NAME                      TYPE        CLUSTER-IP      EXTERNAL-IP   PORT<span class="o">(</span>S<span class="o">)</span>   AGE
&gt; service/connaisseur-svc   ClusterIP   <span class="m">10</span>.108.220.34   &lt;none&gt;        <span class="m">443</span>/TCP   22s
&gt;
&gt; NAME                                     READY   UP-TO-DATE   AVAILABLE   AGE
&gt; deployment.apps/connaisseur-deployment   <span class="m">3</span>/3     <span class="m">3</span>            <span class="m">3</span>           22s
&gt;
&gt; NAME                                                DESIRED   CURRENT   READY   AGE
&gt; replicaset.apps/connaisseur-deployment-78d8975596   <span class="m">3</span>         <span class="m">3</span>         <span class="m">3</span>       22s
</code></pre></div>
<h3 id="use">Use<a class="headerlink" href="#use" title="Permanent link">⚓︎</a></h3>
<p>To use Connaisseur, simply try running some images or apply a deployment.
In case you use the pre-configuration, you could for example run the following commands:</p>
<div class="highlight"><pre><span></span><code>kubectl run demo --image<span class="o">=</span>docker.io/securesystemsengineering/testimage:unsigned
&gt; Error from server: admission webhook <span class="s2">&quot;connaisseur-svc.connaisseur.svc&quot;</span> denied the request <span class="o">(</span>...<span class="o">)</span>.

kubectl run hello-world --image<span class="o">=</span>docker.io/hello-world
&gt; pod/hello-world created
</code></pre></div>
<h3 id="delete">Delete<a class="headerlink" href="#delete" title="Permanent link">⚓︎</a></h3>
<p>Just like for installation, Helm can also be used to delete Connaisseur from your cluster:</p>
<div class="highlight"><pre><span></span><code>helm uninstall connaisseur -n connaisseur
</code></pre></div>
<p>In case uninstallation fails or problems occur during subsequent installation, you can manually remove all resources:</p>
<div class="highlight"><pre><span></span><code>kubectl delete all,mutatingwebhookconfigurations,clusterroles,clusterrolebindings,configmaps,imagepolicies,secrets,serviceaccounts,customresourcedefinitions -lapp.kubernetes.io/instance<span class="o">=</span>connaisseur
kubectl delete namespaces connaisseur
</code></pre></div>
<p>Connaisseur for example also installs a <em>CutstomResourceDefinition</em> <code>imagepolicies.connaisseur.policy</code> that validates its configuration.
In case of major releases, the configuration structure might change which can cause installation to fail and you might have to delete it manually.</p>
<h3 id="makefile">Makefile<a class="headerlink" href="#makefile" title="Permanent link">⚓︎</a></h3>
<p>Alternatively to using Helm, you can also run the Makefile for installing, deleting and more. Here the available commands:</p>
<ul>
<li><code>make install</code> -- Runs the <code>helm install</code> command.</li>
<li><code>make uninstall</code> -- Switches the namespace to <code>connaisseur</code>, uses the <code>helm uninstall</code> command and deletes the <code>connaisseur</code> namespace.</li>
<li><code>make annihilate</code> -- Deletes all resources labeled with <code>app.kubernetes.io/instance=connaisseur</code> as well as the <code>connaisseur</code> namespace. This command is usually helpful, should the normal <code>make uninstall</code> not work.</li>
<li><code>make docker</code> -- Builds the <em>connaisseur</em> and <em>connaisseur:helm-hook</em> (relevant for installing Connaisseur) container images.</li>
</ul>
<h2 id="detailed-configuration">Detailed configuration<a class="headerlink" href="#detailed-configuration" title="Permanent link">⚓︎</a></h2>
<p>All configuration is done in the <code>helm/values.yaml</code>.
The configuration of features is only described in the <a href="../features/">corresponding section</a>.</p>
<h3 id="validators">Validators<a class="headerlink" href="#validators" title="Permanent link">⚓︎</a></h3>
<p>The validators are configured in the <code>validators</code> field, which defines a list of validator objects.</p>
<p>A validator defines what kind of signatures are to be expected, how signatures are to be validated, against which trust root and how to access the signature data.
For example, images might be signed with Docker Content Trust and reside in a private registry.
Thus the validator would need to specify <code>notaryv1</code> as type, the notary host and the required credentials.</p>
<p>The specific validator type should be chosen based on the use case.
A list of supported validator types can be found <a href="../validators/">here</a>.
All validators share a similar structure for configuration.
For specifics and additional options, please review the dedicated page of the validator type.</p>
<p>There is a special behavior, when a validator or one of the trust roots is named <code>default</code>.
In this case, should an image policy rule not specify a validator or trust root to use, the one named <code>default</code> will be used instead.
This also means there can only be one validator named <code>default</code> and for the trust roots, there can only be one called <code>default</code> within a single validator.</p>
<p>Connaisseur comes with a few validators pre-configured including one for Docker's official images.
The pre-configured validators can be removed.
However to avoid Connaisseur failing its own validation in case you remove the <code>securesystemsengineering_official</code> key, make sure to also exclude Connaisseur from validation either via the static <code>allow</code> validator or <a href="../features/namespaced_validation/">namespaced validation</a>.
The special case of static validators used to simply allow or deny images without verification is described below.</p>
<h4 id="configuration-options">Configuration options<a class="headerlink" href="#configuration-options" title="Permanent link">⚓︎</a></h4>
<p><code>.validators[*]</code> in <code>helm/values.yaml</code> supports the following keys:</p>
<table>
<thead>
<tr>
<th>Key</th>
<th>Default</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>name</code></td>
<td>-</td>
<td><img alt="✔" class="twemoji" src="https://twemoji.maxcdn.com/v/latest/svg/2714.svg" title=":heavy_check_mark:" /></td>
<td>Name of the validator, which is referenced in the image policy. It must consist of lower case alphanumeric characters or '-'. If the name is <code>default</code>, it will be used if no validator is specified.</td>
</tr>
<tr>
<td><code>type</code></td>
<td>-</td>
<td><img alt="✔" class="twemoji" src="https://twemoji.maxcdn.com/v/latest/svg/2714.svg" title=":heavy_check_mark:" /></td>
<td>Type of the validator, e.g. <code>notaryv1</code> or <code>cosign</code>, which is dependent on the <a href="../validators/">signing solution in use</a>.</td>
</tr>
<tr>
<td><code>trust_roots</code></td>
<td>-</td>
<td><img alt="✔" class="twemoji" src="https://twemoji.maxcdn.com/v/latest/svg/2714.svg" title=":heavy_check_mark:" /></td>
<td>List of trust anchors to validate the signatures against. In practice, this is typically a list of public keys.</td>
</tr>
<tr>
<td><code>trust_roots[*].name</code></td>
<td>-</td>
<td><img alt="✔" class="twemoji" src="https://twemoji.maxcdn.com/v/latest/svg/2714.svg" title=":heavy_check_mark:" /></td>
<td>Name of the trust anchor, which is referenced in the image policy. If the name is <code>default</code>, it will be used if no key is specified.</td>
</tr>
<tr>
<td><code>trust_roots[*].key</code></td>
<td>-</td>
<td><img alt="✔" class="twemoji" src="https://twemoji.maxcdn.com/v/latest/svg/2714.svg" title=":heavy_check_mark:" /></td>
<td>Value of the trust anchor, most commonly a PEM encoded public key.</td>
</tr>
<tr>
<td><code>auth</code></td>
<td>-</td>
<td></td>
<td>Credentials that should be used in case authentication is required for validation. Details are provided on validator-specific pages.</td>
</tr>
</tbody>
</table>
<p><em>Further configuration fields specific to the validator type are described in the <a href="../validators/">respective section</a>.</em></p>
<h4 id="example">Example<a class="headerlink" href="#example" title="Permanent link">⚓︎</a></h4>
<div class="highlight"><pre><span></span><code><span class="nt">validators</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">default</span>
  <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">notaryv1</span>
  <span class="nt">host</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">notary.docker.io</span>
  <span class="nt">trust_roots</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">default</span>
    <span class="nt">key</span><span class="p">:</span> <span class="p p-Indicator">|</span>
      <span class="no">-----BEGIN PUBLIC KEY-----</span>
      <span class="no">MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEsx28WV7BsQfnHF1kZmpdCTTLJaWe</span>
      <span class="no">d0CA+JOi8H4REuBaWSZ5zPDe468WuOJ6f71E7WFg3CVEVYHuoZt2UYbN/Q==</span>
      <span class="no">-----END PUBLIC KEY-----</span>
  <span class="nt">auth</span><span class="p">:</span>
    <span class="nt">username</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">superuser</span>
    <span class="nt">password</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">lookatmeimjumping</span>
<span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">myvalidator</span>
  <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">cosign</span>
  <span class="nt">trust_roots</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">mykey</span>
    <span class="nt">key</span><span class="p">:</span> <span class="p p-Indicator">|</span>
      <span class="no">-----BEGIN PUBLIC KEY-----</span>
      <span class="no">MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEIFXO1w6oj0oI2Fk9SiaNJRKTiO9d</span>
      <span class="no">ksm6hFczQAq+FDdw0istEdCwcHO61O/0bV+LC8jqFoomA28cT+py6FcSYw==</span>
      <span class="no">-----END PUBLIC KEY-----</span>
</code></pre></div>
<h4 id="static-validators">Static validators<a class="headerlink" href="#static-validators" title="Permanent link">⚓︎</a></h4>
<p>Static validators are a special type of validator that does not validate any signatures.
Depending on the <code>approve</code> value being <code>true</code> or <code>false</code>, they either allow or deny all images for which they are specified as validator.
This for example allows to implement an <em>allowlist</em> or <em>denylist</em>.</p>
<h5 id="configuration-options_1">Configuration options<a class="headerlink" href="#configuration-options_1" title="Permanent link">⚓︎</a></h5>
<table>
<thead>
<tr>
<th>Key</th>
<th>Default</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>name</code></td>
<td>-</td>
<td><img alt="✔" class="twemoji" src="https://twemoji.maxcdn.com/v/latest/svg/2714.svg" title=":heavy_check_mark:" /></td>
<td>Name of the validator, which will be used to reference it in the image policy.</td>
</tr>
<tr>
<td><code>type</code></td>
<td>-</td>
<td><img alt="✔" class="twemoji" src="https://twemoji.maxcdn.com/v/latest/svg/2714.svg" title=":heavy_check_mark:" /></td>
<td><code>static</code>; value has to be <code>static</code> for a static validator.</td>
</tr>
<tr>
<td><code>approve</code></td>
<td>-</td>
<td><img alt="✔" class="twemoji" src="https://twemoji.maxcdn.com/v/latest/svg/2714.svg" title=":heavy_check_mark:" /></td>
<td><code>true</code> or <code>false</code> to admit or deny all images.</td>
</tr>
</tbody>
</table>
<h5 id="example_1">Example<a class="headerlink" href="#example_1" title="Permanent link">⚓︎</a></h5>
<div class="highlight"><pre><span></span><code><span class="nt">validators</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">allow</span>
  <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">static</span>
  <span class="nt">approve</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">deny</span>
  <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">static</span>
  <span class="nt">approve</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
</code></pre></div>
<h3 id="image-policy">Image policy<a class="headerlink" href="#image-policy" title="Permanent link">⚓︎</a></h3>
<p>The image policy is defined in the <code>policy</code> field and acts as a list of rule objects to determine which image should be validated by which validator (and potentially some further configurations).</p>
<p>For each image in the admission request, only a single rule in the image policy will apply: the one with the <em>most specific</em> matching <code>pattern</code> field.
This is determined by the following algorithm:</p>
<ol>
<li>A given image is matched against all rule patterns.</li>
<li>All matching patterns are compared to one another to determine the most specific one (see below). Only two patterns are compared at a time; the more specific one then is compared to the next one and so forth. Specificity is determined as follows:<ol>
<li>Patterns are split into components (delimited by "/"). The pattern that has a higher number of components wins (is considered more specific).</li>
<li>Should the two patterns that are being compared have equal number of components, the longest common prefix between each pattern component and corresponding image component are calculated (for this purpose, image identifiers are also split into components). The pattern with the longest common prefix in one component, starting from the leftmost, wins.</li>
<li>Should all longest common prefixes of all components between the two compared patterns be equal, the pattern with a longer component, starting from the leftmost, wins.</li>
<li>The rule whose pattern has won all comparisons is considered the most specific rule.</li>
</ol>
</li>
<li>Return the most specific rule.</li>
</ol>
<p>Should an image match none of the rules, Connaisseur will deny the request and raise an error.
This <em>deny per default</em> behavior can be changed via a <em>catch-all</em> rule <code>*:*</code> and for example using the static <code>allow</code> validator in order to admit otherwise unmatched images.</p>
<p>In order to perform the actual validation, Connaisseur will call the validator specified in the selected rule and pass the image name and potential further configuration to it.
The reference to validator and exact trust root is resolved in the following way:</p>
<ol>
<li>The validator with name (<code>validators[*].name</code>) equal to the <code>validator</code> value in the selected rule is chosen. If no validator is specified, the validator with name <code>default</code> is used if it exists.</li>
<li>Of that validator, the trust root (e.g. public key) is chosen which name (<code>.validators.trust_roots[*].name</code>) matches the policies trust root string (<code>with.trust_root</code>). If no trust root is specified, the trust root with name <code>default</code> is used if it exists.</li>
</ol>
<p>Let's review the pattern and validator matching at a minimal example.
We consider the following validator and policy configuration (most fields have been omitted for clarity):</p>
<div class="highlight"><pre><span></span><code><span class="nt">validators</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">default</span>     <span class="c1"># validator 1</span>
  <span class="nt">trust_roots</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">default</span>   <span class="c1"># key 1</span>
    <span class="nt">key</span><span class="p">:</span> <span class="p p-Indicator">|</span>
      <span class="no">...</span>
<span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">myvalidator</span> <span class="c1"># validator 2</span>
  <span class="nt">trust_roots</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">default</span>   <span class="c1"># key 2</span>
    <span class="nt">key</span><span class="p">:</span> <span class="p p-Indicator">|</span>
      <span class="no">...</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">mykey</span>     <span class="c1"># key 3</span>
    <span class="nt">key</span><span class="p">:</span> <span class="p p-Indicator">|</span>
      <span class="no">...</span>

<span class="nt">policy</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="nt">pattern</span><span class="p">:</span> <span class="s">&quot;*:*&quot;</span>                      <span class="c1"># rule 1</span>
<span class="p p-Indicator">-</span> <span class="nt">pattern</span><span class="p">:</span> <span class="s">&quot;docker.io/myrepo/*:*&quot;</span>     <span class="c1"># rule 2</span>
  <span class="nt">validator</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">myvalidator</span>
<span class="p p-Indicator">-</span> <span class="nt">pattern</span><span class="p">:</span> <span class="s">&quot;docker.io/myrepo/myimg:*&quot;</span> <span class="c1"># rule 3</span>
  <span class="nt">validator</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">myvalidator</span>
  <span class="nt">with</span><span class="p">:</span>
    <span class="nt">trust_root</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">mykey</span>
</code></pre></div>
<p>Now deploying the following images we would get the matchings:</p>
<ul>
<li><code>docker.io/superrepo/myimg:v1</code> &rarr; <em>rule 1</em> &rarr; <em>validator 1</em>(<em>key 1</em>): The image matches none of the more specific rules 2 and 3, so rule 1 is applied. As that rule neither specifies a validator nor a trust root, the <code>default</code> validator (validator 1) with trust root <code>default</code> (key 1) is used.</li>
<li><code>docker.io/myrepo/superimg:v1</code> &rarr; <em>rule 2</em> &rarr; <em>validator 2</em>(<em>key 2</em>): The image only matches rules 1 and 2 and thus 2 is chosen as it is more specific. That rule specifies <code>myvalidator</code> as validator but no trust root and thus validator 2 with trust root <code>default</code> (key 2) is used.</li>
<li><code>docker.io/myrepo/myimg:v1</code> &rarr; <em>rule 3</em> &rarr; <em>validator 2</em>(<em>key 3</em>): The image matches all rules and thus 3 is chosen as it is most specific. The rule specifies <code>myvalidator</code> as validator with <code>mykey</code> as trust root and thus validator 2 with key 2 is used.</li>
</ul>
<p>Connaisseur ships with a few rules pre-configured.
There is two rules that should remain intact in some form in order to not brick the Kubernetes cluster:</p>
<ul>
<li><code>k8s.gcr.io</code>: This is an <code>allow</code> rule for Kubernetes images (<code>k8s.gcr.io</code>) in order to not block cluster relevant images. These cannot be validated currently.</li>
<li><code>docker.io/securesystemsengineering/*:*</code>: This rule is used to validate the Connaisseur images with the respective validator and removal can break the Connaisseur deployment. It is, however, possible to use the static <code>allow</code> validator.</li>
</ul>
<h4 id="configuration-options_2">Configuration options<a class="headerlink" href="#configuration-options_2" title="Permanent link">⚓︎</a></h4>
<p><code>.policy[*]</code> in <code>helm/values.yaml</code> supports the following keys:</p>
<table>
<thead>
<tr>
<th>Key</th>
<th>Default</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>pattern</code></td>
<td>-</td>
<td><img alt="✔" class="twemoji" src="https://twemoji.maxcdn.com/v/latest/svg/2714.svg" title=":heavy_check_mark:" /></td>
<td>Globbing pattern to match an image name against.</td>
</tr>
<tr>
<td><code>validator</code></td>
<td><code>default</code></td>
<td></td>
<td>Name of a validator in the <code>validators</code> list. If not provided, the validator with name <code>default</code> is used if it exists.</td>
</tr>
<tr>
<td><code>with</code></td>
<td>-</td>
<td></td>
<td>Additional parameters to use for a validator. See more specifics in <a href="../validators/">validator section</a>.</td>
</tr>
<tr>
<td><code>with.trust_root</code></td>
<td><code>default</code></td>
<td></td>
<td>Name of a trust root, which is specified within the referenced validator. If not provided, the trust root with name <code>default</code> is used if it exists.</td>
</tr>
</tbody>
</table>
<h4 id="example_2">Example<a class="headerlink" href="#example_2" title="Permanent link">⚓︎</a></h4>
<div class="highlight"><pre><span></span><code><span class="nt">policy</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="nt">pattern</span><span class="p">:</span> <span class="s">&quot;*:*&quot;</span>
<span class="p p-Indicator">-</span> <span class="nt">pattern</span><span class="p">:</span> <span class="s">&quot;docker.io/myrepo/*:*&quot;</span>
  <span class="nt">validator</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">myvalidator</span>
  <span class="nt">with</span><span class="p">:</span>
    <span class="nt">trust_root</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">mykey</span>
<span class="p p-Indicator">-</span> <span class="nt">pattern</span><span class="p">:</span> <span class="s">&quot;docker.io/myrepo/deniedimage:*&quot;</span>
  <span class="nt">validator</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">deny</span>
<span class="p p-Indicator">-</span> <span class="nt">pattern</span><span class="p">:</span> <span class="s">&quot;docker.io/myrepo/allowedimage:v*&quot;</span>
  <span class="nt">validator</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">allow</span>
</code></pre></div>
<h3 id="common-examples">Common examples<a class="headerlink" href="#common-examples" title="Permanent link">⚓︎</a></h3>
<p>Let's look at some useful examples for the <code>validators</code> and <code>policy</code> configuration.
These can serve as a first template beyond the pre-configuration or might just be instructive to understand validators and policies.</p>
<p>We assume your repository is <code>docker.io/myrepo</code> and a public key has been created.
In case this repository is private, authentication would have to be added to the respective validator for example via:</p>
<div class="highlight"><pre><span></span><code>  <span class="nt">auth</span><span class="p">:</span>
    <span class="nt">secret_name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">k8ssecret</span>
</code></pre></div>
<p>The Kubernetes secret would have to be created separately according to the validator documentation.</p>
<h4 id="case-only-validate-own-images-and-deny-all-others">Case: Only validate own images and deny all others<a class="headerlink" href="#case-only-validate-own-images-and-deny-all-others" title="Permanent link">⚓︎</a></h4>
<p>This is likely the most common case in simple settings by which only self-built images are used and validated against your own public key:</p>
<div class="highlight"><pre><span></span><code><span class="nt">validators</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">allow</span>
  <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">static</span>
  <span class="nt">approve</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">default</span>
  <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">notaryv1</span>  <span class="c1"># or e.g. &#39;cosign&#39;</span>
  <span class="nt">host</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">notary.docker.io</span>  <span class="c1"># only required in case of notaryv1</span>
  <span class="nt">trust_roots</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">default</span>
    <span class="nt">key</span><span class="p">:</span> <span class="p p-Indicator">|</span>  <span class="c1"># your public key below</span>
      <span class="no">-----BEGIN PUBLIC KEY-----</span>
      <span class="no">MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEvtc/qpHtx7iUUj+rRHR99a8mnGni</span>
      <span class="no">qiGkmUb9YpWWTS4YwlvwdmMDiGzcsHiDOYz6f88u2hCRF5GUCvyiZAKrsA==</span>
      <span class="no">-----END PUBLIC KEY-----</span>
<span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">dockerhub_basics</span>
  <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">notaryv1</span>
  <span class="nt">host</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">notary.docker.io</span>
  <span class="nt">trust_roots</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">securesystemsengineering_official</span>
    <span class="nt">key</span><span class="p">:</span> <span class="p p-Indicator">|</span>
      <span class="no">-----BEGIN PUBLIC KEY-----</span>
      <span class="no">MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEsx28WV7BsQfnHF1kZmpdCTTLJaWe</span>
      <span class="no">d0CA+JOi8H4REuBaWSZ5zPDe468WuOJ6f71E7WFg3CVEVYHuoZt2UYbN/Q==</span>
      <span class="no">-----END PUBLIC KEY-----</span>

<span class="nt">policy</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="nt">pattern</span><span class="p">:</span> <span class="s">&quot;*:*&quot;</span>
<span class="p p-Indicator">-</span> <span class="nt">pattern</span><span class="p">:</span> <span class="s">&quot;k8s.gcr.io/*:*&quot;</span>
  <span class="nt">validator</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">allow</span>
<span class="p p-Indicator">-</span> <span class="nt">pattern</span><span class="p">:</span> <span class="s">&quot;docker.io/securesystemsengineering/*:*&quot;</span>
  <span class="nt">validator</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">dockerhub_basics</span>
  <span class="nt">with</span><span class="p">:</span>
    <span class="nt">trust_root</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">securesystemsengineering_official</span>
</code></pre></div>
<h4 id="case-only-validate-own-images-and-deny-all-others-faster">Case: Only validate own images and deny all others (faster)<a class="headerlink" href="#case-only-validate-own-images-and-deny-all-others-faster" title="Permanent link">⚓︎</a></h4>
<p>This configuration achieves the same as the one above, but is faster as trust data only needs to be requested for images in your repository:</p>
<div class="highlight"><pre><span></span><code><span class="nt">validators</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">allow</span>
  <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">static</span>
  <span class="nt">approve</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">deny</span>
  <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">static</span>
  <span class="nt">approve</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">default</span>
  <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">notaryv1</span>  <span class="c1"># or e.g. &#39;cosign&#39;</span>
  <span class="nt">host</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">notary.docker.io</span>  <span class="c1"># only required in case of notaryv1</span>
  <span class="nt">trust_roots</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">default</span>
    <span class="nt">key</span><span class="p">:</span> <span class="p p-Indicator">|</span>  <span class="c1"># your public key below</span>
      <span class="no">-----BEGIN PUBLIC KEY-----</span>
      <span class="no">MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEvtc/qpHtx7iUUj+rRHR99a8mnGni</span>
      <span class="no">qiGkmUb9YpWWTS4YwlvwdmMDiGzcsHiDOYz6f88u2hCRF5GUCvyiZAKrsA==</span>
      <span class="no">-----END PUBLIC KEY-----</span>
<span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">dockerhub_basics</span>
  <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">notaryv1</span>
  <span class="nt">host</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">notary.docker.io</span>
  <span class="nt">trust_roots</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">securesystemsengineering_official</span>
    <span class="nt">key</span><span class="p">:</span> <span class="p p-Indicator">|</span>
      <span class="no">-----BEGIN PUBLIC KEY-----</span>
      <span class="no">MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEsx28WV7BsQfnHF1kZmpdCTTLJaWe</span>
      <span class="no">d0CA+JOi8H4REuBaWSZ5zPDe468WuOJ6f71E7WFg3CVEVYHuoZt2UYbN/Q==</span>
      <span class="no">-----END PUBLIC KEY-----</span>

<span class="nt">policy</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="nt">pattern</span><span class="p">:</span> <span class="s">&quot;*:*&quot;</span>
  <span class="nt">validator</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">deny</span>
<span class="p p-Indicator">-</span> <span class="nt">pattern</span><span class="p">:</span> <span class="s">&quot;docker.io/myrepo/*:*&quot;</span>
<span class="p p-Indicator">-</span> <span class="nt">pattern</span><span class="p">:</span> <span class="s">&quot;k8s.gcr.io/*:*&quot;</span>
  <span class="nt">validator</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">allow</span>
<span class="p p-Indicator">-</span> <span class="nt">pattern</span><span class="p">:</span> <span class="s">&quot;docker.io/securesystemsengineering/*:*&quot;</span>
  <span class="nt">validator</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">dockerhub_basics</span>
  <span class="nt">with</span><span class="p">:</span>
    <span class="nt">trust_root</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">securesystemsengineering_official</span>
</code></pre></div>
<p>The <code>*:*</code> rule could also have been omitted as Connaisseur denies unmatched images.
However, explicit is better than implicit.</p>
<h4 id="case-only-validate-docker-hub-official-images-and-deny-all-others">Case: Only validate Docker Hub official images and deny all others<a class="headerlink" href="#case-only-validate-docker-hub-official-images-and-deny-all-others" title="Permanent link">⚓︎</a></h4>
<p>In case only validated Docker Hub official images should be admitted to the cluster:</p>
<div class="highlight"><pre><span></span><code><span class="nt">validators</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">allow</span>
  <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">static</span>
  <span class="nt">approve</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">deny</span>
  <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">static</span>
  <span class="nt">approve</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">dockerhub_basics</span>
  <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">notaryv1</span>
  <span class="nt">host</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">notary.docker.io</span>
  <span class="nt">trust_roots</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">docker_official</span>
    <span class="nt">key</span><span class="p">:</span> <span class="p p-Indicator">|</span>
      <span class="no">-----BEGIN PUBLIC KEY-----</span>
      <span class="no">MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEOXYta5TgdCwXTCnLU09W5T4M4r9f</span>
      <span class="no">QQrqJuADP6U7g5r9ICgPSmZuRHP/1AYUfOQW3baveKsT969EfELKj1lfCA==</span>
      <span class="no">-----END PUBLIC KEY-----</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">securesystemsengineering_official</span>
    <span class="nt">key</span><span class="p">:</span> <span class="p p-Indicator">|</span>
      <span class="no">-----BEGIN PUBLIC KEY-----</span>
      <span class="no">MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEsx28WV7BsQfnHF1kZmpdCTTLJaWe</span>
      <span class="no">d0CA+JOi8H4REuBaWSZ5zPDe468WuOJ6f71E7WFg3CVEVYHuoZt2UYbN/Q==</span>
      <span class="no">-----END PUBLIC KEY-----</span>

<span class="nt">policy</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="nt">pattern</span><span class="p">:</span> <span class="s">&quot;*:*&quot;</span>
  <span class="nt">validator</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">deny</span>
<span class="p p-Indicator">-</span> <span class="nt">pattern</span><span class="p">:</span> <span class="s">&quot;docker.io/library/*:*&quot;</span>
  <span class="nt">validator</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">dockerhub_basics</span>
  <span class="nt">with</span><span class="p">:</span>
    <span class="nt">trust_root</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">docker_official</span>
<span class="p p-Indicator">-</span> <span class="nt">pattern</span><span class="p">:</span> <span class="s">&quot;k8s.gcr.io/*:*&quot;</span>
  <span class="nt">validator</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">allow</span>
<span class="p p-Indicator">-</span> <span class="nt">pattern</span><span class="p">:</span> <span class="s">&quot;docker.io/securesystemsengineering/*:*&quot;</span>
  <span class="nt">validator</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">dockerhub_basics</span>
  <span class="nt">with</span><span class="p">:</span>
    <span class="nt">trust_root</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">securesystemsengineering_official</span>
</code></pre></div>
<h4 id="case-only-validate-docker-hub-official-images-and-allow-all-others">Case: Only validate Docker Hub official images and allow all others<a class="headerlink" href="#case-only-validate-docker-hub-official-images-and-allow-all-others" title="Permanent link">⚓︎</a></h4>
<p>In case only Docker Hub official images should be validated while all others are simply admitted:</p>
<div class="highlight"><pre><span></span><code><span class="nt">validators</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">allow</span>
  <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">static</span>
  <span class="nt">approve</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">deny</span>
  <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">static</span>
  <span class="nt">approve</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">dockerhub_basics</span>
  <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">notaryv1</span>
  <span class="nt">host</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">notary.docker.io</span>
  <span class="nt">trust_roots</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">docker_official</span>
    <span class="nt">key</span><span class="p">:</span> <span class="p p-Indicator">|</span>
      <span class="no">-----BEGIN PUBLIC KEY-----</span>
      <span class="no">MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEOXYta5TgdCwXTCnLU09W5T4M4r9f</span>
      <span class="no">QQrqJuADP6U7g5r9ICgPSmZuRHP/1AYUfOQW3baveKsT969EfELKj1lfCA==</span>
      <span class="no">-----END PUBLIC KEY-----</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">securesystemsengineering_official</span>
    <span class="nt">key</span><span class="p">:</span> <span class="p p-Indicator">|</span>
      <span class="no">-----BEGIN PUBLIC KEY-----</span>
      <span class="no">MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEsx28WV7BsQfnHF1kZmpdCTTLJaWe</span>
      <span class="no">d0CA+JOi8H4REuBaWSZ5zPDe468WuOJ6f71E7WFg3CVEVYHuoZt2UYbN/Q==</span>
      <span class="no">-----END PUBLIC KEY-----</span>

<span class="nt">policy</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="nt">pattern</span><span class="p">:</span> <span class="s">&quot;*:*&quot;</span>
  <span class="nt">validator</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">allow</span>
<span class="p p-Indicator">-</span> <span class="nt">pattern</span><span class="p">:</span> <span class="s">&quot;docker.io/library/*:*&quot;</span>
  <span class="nt">validator</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">dockerhub_basics</span>
  <span class="nt">with</span><span class="p">:</span>
    <span class="nt">trust_root</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">docker_official</span>
<span class="p p-Indicator">-</span> <span class="nt">pattern</span><span class="p">:</span> <span class="s">&quot;k8s.gcr.io/*:*&quot;</span>
  <span class="nt">validator</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">allow</span>
<span class="p p-Indicator">-</span> <span class="nt">pattern</span><span class="p">:</span> <span class="s">&quot;docker.io/securesystemsengineering/*:*&quot;</span>
  <span class="nt">validator</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">dockerhub_basics</span>
  <span class="nt">with</span><span class="p">:</span>
    <span class="nt">trust_root</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">securesystemsengineering_official</span>
</code></pre></div>
<h4 id="case-directly-admit-own-images-and-deny-all-others">Case: Directly admit own images and deny all others<a class="headerlink" href="#case-directly-admit-own-images-and-deny-all-others" title="Permanent link">⚓︎</a></h4>
<p>As a matter of fact, Connaisseur can also be used to restrict the allowed registries and repositories without signature validation:</p>
<div class="highlight"><pre><span></span><code><span class="nt">validators</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">allow</span>
  <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">static</span>
  <span class="nt">approve</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">deny</span>
  <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">static</span>
  <span class="nt">approve</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>

<span class="nt">policy</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="nt">pattern</span><span class="p">:</span> <span class="s">&quot;*:*&quot;</span>
  <span class="nt">validator</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">deny</span>
<span class="p p-Indicator">-</span> <span class="nt">pattern</span><span class="p">:</span> <span class="s">&quot;docker.io/myrepo/*:*&quot;</span>
  <span class="nt">validator</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">allow</span>
<span class="p p-Indicator">-</span> <span class="nt">pattern</span><span class="p">:</span> <span class="s">&quot;k8s.gcr.io/*:*&quot;</span>
  <span class="nt">validator</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">allow</span>
<span class="p p-Indicator">-</span> <span class="nt">pattern</span><span class="p">:</span> <span class="s">&quot;docker.io/securesystemsengineering/*:*&quot;</span>
  <span class="nt">validator</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">allow</span>
</code></pre></div>
                
              
              
                


              
            </article>
          </div>
        </div>
        
          <a href="#" class="md-top md-icon" data-md-component="top" data-md-state="hidden">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"/></svg>
            Back to top
          </a>
        
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../getting_started/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Getting Started" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Getting Started
            </div>
          </div>
        </a>
      
      
        
        <a href="../validators/" class="md-footer__link md-footer__link--next" aria-label="Next: Overview" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Overview
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            <a href="https://securesystems.de">Secure Systems Engineering GmbH</a>
          </div>
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
        
      </div>
      
  <div class="md-footer-social">
    
      
      
      <a href="https://github.com/sse-secure-systems" target="_blank" rel="noopener" title="SSE on GitHub" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
      </a>
    
      
      
      <a href="https://hub.docker.com/r/securesystemsengineering/connaisseur" target="_blank" rel="noopener" title="Connaisseur images on Docker Hub" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><path d="M349.9 236.3h-66.1v-59.4h66.1v59.4zm0-204.3h-66.1v60.7h66.1V32zm78.2 144.8H362v59.4h66.1v-59.4zm-156.3-72.1h-66.1v60.1h66.1v-60.1zm78.1 0h-66.1v60.1h66.1v-60.1zm276.8 100c-14.4-9.7-47.6-13.2-73.1-8.4-3.3-24-16.7-44.9-41.1-63.7l-14-9.3-9.3 14c-18.4 27.8-23.4 73.6-3.7 103.8-8.7 4.7-25.8 11.1-48.4 10.7H2.4c-8.7 50.8 5.8 116.8 44 162.1 37.1 43.9 92.7 66.2 165.4 66.2 157.4 0 273.9-72.5 328.4-204.2 21.4.4 67.6.1 91.3-45.2 1.5-2.5 6.6-13.2 8.5-17.1l-13.3-8.9zm-511.1-27.9h-66v59.4h66.1v-59.4zm78.1 0h-66.1v59.4h66.1v-59.4zm78.1 0h-66.1v59.4h66.1v-59.4zm-78.1-72.1h-66.1v60.1h66.1v-60.1z"/></svg>
      </a>
    
      
      
      <a href="https://medium.com/sse-blog" target="_blank" rel="noopener" title="SSE on Medium" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M0 32v448h448V32H0zm372.2 106.1-24 23c-2.1 1.6-3.1 4.2-2.7 6.7v169.3c-.4 2.6.6 5.2 2.7 6.7l23.5 23v5.1h-118V367l24.3-23.6c2.4-2.4 2.4-3.1 2.4-6.7V199.8l-67.6 171.6h-9.1L125 199.8v115c-.7 4.8 1 9.7 4.4 13.2l31.6 38.3v5.1H71.2v-5.1l31.6-38.3c3.4-3.5 4.9-8.4 4.1-13.2v-133c.4-3.7-1-7.3-3.8-9.8L75 138.1V133h87.3l67.4 148L289 133.1h83.2v5z"/></svg>
      </a>
    
      
      
      <a href="https://www.youtube.com/channel/UCReAmr98RzwYZeWG6CAwOhg" target="_blank" rel="noopener" title="SSE on YouTube" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><path d="M549.655 124.083c-6.281-23.65-24.787-42.276-48.284-48.597C458.781 64 288 64 288 64S117.22 64 74.629 75.486c-23.497 6.322-42.003 24.947-48.284 48.597-11.412 42.867-11.412 132.305-11.412 132.305s0 89.438 11.412 132.305c6.281 23.65 24.787 41.5 48.284 47.821C117.22 448 288 448 288 448s170.78 0 213.371-11.486c23.497-6.321 42.003-24.171 48.284-47.821 11.412-42.867 11.412-132.305 11.412-132.305s0-89.438-11.412-132.305zm-317.51 213.508V175.185l142.739 81.205-142.739 81.201z"/></svg>
      </a>
    
      
      
      <a href="https://twitter.com/sse_gmbh" target="_blank" rel="noopener" title="SSE on Twitter" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
      </a>
    
      
      
      <a href="https://www.linkedin.com/company/sse-secure-systems-engineering" target="_blank" rel="noopener" title="SSE on LinkedIn" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg>
      </a>
    
      
      
      <a href="https://www.securesystems.de/" target="_blank" rel="noopener" title="SSE Website" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg>
      </a>
    
      
      
      <a href="mailto:connaisseur@securesystems.dev" target="_blank" rel="noopener" title="Email contact" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M502.3 190.8c3.9-3.1 9.7-.2 9.7 4.7V400c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V195.6c0-5 5.7-7.8 9.7-4.7 22.4 17.4 52.1 39.5 154.1 113.6 21.1 15.4 56.7 47.8 92.2 47.6 35.7.3 72-32.8 92.3-47.6 102-74.1 131.6-96.3 154-113.7zM256 320c23.2.4 56.6-29.2 73.4-41.4 132.7-96.3 142.8-104.7 173.4-128.7 5.8-4.5 9.2-11.5 9.2-18.9v-19c0-26.5-21.5-48-48-48H48C21.5 64 0 85.5 0 112v19c0 7.4 3.4 14.3 9.2 18.9 30.6 23.9 40.7 32.4 173.4 128.7 16.8 12.2 50.2 41.8 73.4 41.4z"/></svg>
      </a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.top"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../assets/javascripts/workers/search.709b4209.min.js", "version": {"provider": "mike"}}</script>
    
    
      <script src="../assets/javascripts/bundle.febc23d1.min.js"></script>
      
    
  </body>
</html>